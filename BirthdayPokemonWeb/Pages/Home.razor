@page "/"


<PageTitle>Find your Birthday Pokémon</PageTitle>

<div class="pokemon-page">
    <div class="pokemon-card shadow">

        <h1 class="text-center mb-3">🎉 Find Your Birthday Pokémon! 🎉</h1>

        <p class="text-center text-muted mb-4">
            Enter your birth date and let the Pokédex decide your birthday match!
        </p>

        <div class="mb-3">
            <label class="form-label fw-bold">Choose Your Birth Date</label>
            <p class="small text-muted">
                Default format is <strong>dd/mm/yyyy</strong>.
                You can switch between <strong>dd/mm</strong> and <strong>mm/dd</strong> below.
            </p>

            <p class="small text-muted">
                We are not saving any birth data. Your birth date is only used to determine your Pokémon. Also note that we do not uses year information for the standard calculation.
                You can find the open source project here: <a class="github-link" href="https://github.com/djinnet/BirthdayPokemon">Github</a>
            </p>

            <DateInput TValue="DateOnly"
            @bind-Value="@Birthday"
            Placeholder="Select your birth date"
            Class="w-100" />
        </div>

        <div class="format-toggle mb-4">
            <Switch @bind-Value="MonthDayFormat"
            Label="Use Month-Day Format (MM/DD)?" />
            <p class="small text-muted mt-1">
                Current format: <strong>@InputFormat</strong>
            </p>
        </div>

        <div class="format-toggle mb-4">
            <p class="small text-muted">
                This is the calculation method used to determine your Birthday Pokémon. <br />
                You can choose different methods to see how they affect the result. <br />
                <strong>Standard</strong> means the original calculation method which is calculated by taking the month and day of your birthday. <br />
                <strong>Seed</strong> means the calculation method which uses an mixure of your birth date and a "pseudo-random" seed value to determine your Pokémon. <br />
                <strong>Year</strong> means the calculation method which includes the year of your birth date in the calculation.
            </p>
            <InputSelect @bind-Value="@CurrentCalcuationType">
                @foreach (var value in Enum.GetValues<EPokemonBirthdayCalculationType>())
                {
                    <option value="@value">@value</option>
                }
            </InputSelect>
            <p class="small text-muted mt-1">
                Current calculation: <strong>@(CurrentCalcuationType.ToString()) </strong>
            </p>
        </div>

        <div class="text-center">
            <Button Class="btn-lg mt-3"
            Color="ButtonColor.Primary"
            Size="ButtonSize.Large"
            @onclick="OnGetBirthdayPokemonAsync">
                Show My Pokémon
            </Button>
        </div>

        @if (IsLoading)
        {
            <div class="pokeball-loader-container">
                <div class="pokeball-loader"></div>
                <p class="loading-text">Catching your Pokémon…</p>
            </div>
        }
        else
        {
            @if (!string.IsNullOrEmpty(PokemonImageUrl))
            {
                <div class="pokemon-result text-center mt-5">
                    <h3>Your Pokémon is:</h3>

                    <img src="@PokemonImageUrl"
                         alt="Pokemon Image"
                         class="pokemon-image shadow" />

                    <div class="mt-3 fs-4">
                        <span class="fw-bold">#@PokedexNumber</span>
                        <span>— @PokemonName</span>
                    </div>
                </div>

                @if (!string.IsNullOrEmpty(calculationDetails))
                {
                    <details class="calculation-details mt-4">
                        <summary class="details-summary">
                            🔍 Show Detailed Calculation Steps
                        </summary>

                        <pre class="details-content">
                            @calculationDetails
                        </pre>
                    </details>
                }

            }
            else
            {
                <p class="text-center text-muted mt-4">
                    Select your birth date and press the button to discover your Pokémon!
                </p>
            }
        }
    </div>
</div>
